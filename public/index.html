<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>High-end Hello World</title>
  <style>
    :root{
      --bg1:#0f172a; --bg2:#0ea5e9;
      --card:#0b1220; --accent:#7c3aed;
      --glass: rgba(255,255,255,0.06);
    }
    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial}
    body{
      background: radial-gradient(ellipse at 10% 10%, rgba(124,58,237,0.18), transparent 8%),
                  radial-gradient(ellipse at 90% 90%, rgba(14,165,233,0.12), transparent 12%),
                  linear-gradient(135deg,var(--bg1), #021026 60%);
      display:flex;align-items:center;justify-content:center;color:#e6eef8;
    }
    .card{
      width:min(860px,92vw);
      padding:36px;
      border-radius:16px;
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      box-shadow: 0 10px 40px rgba(2,6,23,0.6), inset 0 1px 0 rgba(255,255,255,0.02);
      backdrop-filter: blur(6px);
      display:grid;grid-template-columns:1fr 320px;gap:24px;align-items:center;
    }
    .hero{
      padding:12px;
    }
    h1{
      margin:0;font-size:clamp(28px,4vw,44px);letter-spacing:-0.02em;
      background: linear-gradient(90deg,#fff 0%, #b6e0ff 40%, #ffd6e0 100%);
      -webkit-background-clip: text; background-clip:text; color:transparent;
    }
    p.lead{margin:12px 0 24px;color:rgba(230,238,248,0.78)}
    .type{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace;
      font-size:18px;padding:14px 18px;border-radius:10px;background:var(--glass);display:inline-block;
      box-shadow: 0 6px 18px rgba(2,6,23,0.45);
    }
    .panel{
      padding:18px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.007));
      border:1px solid rgba(255,255,255,0.03);
    }
    .greet{
      font-weight:600;font-size:20px;margin-bottom:6px;
    }
    .meta{color:rgba(230,238,248,0.6);font-size:13px}
    .btn{
      display:inline-block;margin-top:18px;padding:10px 14px;border-radius:10px;background:linear-gradient(90deg,#7c3aed,#06b6d4);color:white;text-decoration:none;font-weight:600;
      box-shadow: 0 8px 30px rgba(99,102,241,0.18), 0 2px 6px rgba(6,182,212,0.06);
    }
    .canvas-wrap{height:180px;display:flex;align-items:center;justify-content:center}
    /* small decorative orb animation */
    .orb{width:120px;height:120px;border-radius:50%;background:linear-gradient(135deg,#7c3aed,#06b6d4);filter:blur(10px);opacity:0.95;animation:float 6s ease-in-out infinite}
    @keyframes float{0%{transform:translateY(0)}50%{transform:translateY(-18px) rotate(18deg)}100%{transform:translateY(0)}}
    footer{margin-top:18px;color:rgba(230,238,248,0.5);font-size:13px}
  </style>
</head>
<body>
  <div class="card" role="main" aria-labelledby="title">
    <div class="hero">
      <h1 id="title">High-end Hello World</h1>
      <p class="lead">一个既有视觉动效又有后台 API 的现代化示例。前端从 /api/greet 获取问候并循环多语显示。</p>

      <div class="type" id="typed">准备就绪…</div>

      <div style="margin-top:12px">
        <a class="btn" href="#" id="refresh">刷新问候</a>
      </div>

      <footer>由前端从后端实时获取，支持多语与时间戳显示 · 高端感来自细节与交互</footer>
    </div>

    <div class="panel" aria-hidden="false">
      <div class="canvas-wrap">
        <div class="orb" title="hello orb"></div>
      </div>

      <div style="margin-top:12px">
        <div class="greet" id="greet">加载中…</div>
        <div class="meta" id="meta">—</div>
      </div>
    </div>
  </div>

  <script>
    const langs = ["Hello, world!","你好，世界！","Hola, mundo!","Привет, мир!","こんにちは世界！","Bonjour le monde!","Hallo, Welt!","안녕하세요, 세계!"];
    const typedEl = document.getElementById('typed');
    const greetEl = document.getElementById('greet');
    const metaEl = document.getElementById('meta');
    const refresh = document.getElementById('refresh');

    let idx = 0;
    function typeText(str, el, delay=28){
      el.textContent = '';
      let i=0;
      const t = setInterval(()=>{ el.textContent += str[i++]; if(i>=str.length){ clearInterval(t); }}, delay);
    }

    async function fetchGreet(){
      try{
        const res = await fetch('/api/greet');
        const j = await res.json();
        greetEl.textContent = j.message;
        metaEl.textContent = `来自服务器 · ${new Date(j.ts).toLocaleString()} · id=${j.id}`;
      }catch(e){
        greetEl.textContent = "无法连接到 /api/greet";
        metaEl.textContent = "";
      }
    }

    function loopLocal(){
      typeText(langs[idx%langs.length], typedEl);
      idx++;
      setTimeout(loopLocal, 2800);
    }

    refresh.addEventListener('click',(e)=>{
      e.preventDefault();
      fetchGreet();
      refresh.animate([{transform:'translateY(0)'},{transform:'translateY(-4px)'},{transform:'translateY(0)'}],{duration:360});
    });

    // 初始
    loopLocal();
    fetchGreet();
    setInterval(fetchGreet, 15000);
  </script>
</body>
</html>